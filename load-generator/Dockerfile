FROM node:18.14.0-buster-slim
RUN npm install autocannon -g
COPY input.json .
ARG SLEEP_IN_SEC
ARG LOAD_TEST_COMMAND
ARG TARGET_URL
ENV SLEEP_IN_SEC $SLEEP_IN_SEC
ENV LOAD_TEST_COMMAND $LOAD_TEST_COMMAND
ENV TARGET_URL $TARGET_URL
CMD sleep ${SLEEP_IN_SEC} && autocannon ${LOAD_TEST_COMMAND} ${TARGET_URL}